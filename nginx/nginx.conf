# /etc/nginx/nginx.conf (通常由 Nginx 镜像提供基础版本)

# --- 全局设置 ---
# [可填空] 运行 worker 进程的用户，在容器内通常是 nginx 或 root
user nginx;
# [可填空] 工作进程数量，'auto' 会尝试根据 CPU 核心数自动检测
worker_processes auto;
# 全局错误日志
error_log /var/log/nginx/error.log warn;
# 主进程 PID 文件
pid /var/run/nginx.pid;

# --- 事件模块 ---
# 配置网络连接处理
events {
    # [可填空] 每个 worker 进程的最大连接数
    worker_connections 1024;
    # use epoll; # 在 Linux 上通常自动选择最优方法
}

# --- HTTP 模块 ---
# 配置 HTTP 服务核心功能
http {
    # --- 基础 HTTP 设置 ---
    include /etc/nginx/mime.types; # 文件扩展名与 MIME 类型映射
    default_type application/octet-stream; # 默认 MIME 类型

    # --- 日志格式 ---
    # [可填空] 可以自定义日志格式，'main' 是常用预设格式
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
    '$status $body_bytes_sent "$http_referer" '
    '"$http_user_agent" "$http_x_forwarded_for"';

    # --- 访问日志 ---
    # [可填空] 全局访问日志路径和格式
    access_log /var/log/nginx/access.log main;

    # --- 性能相关 ---
    sendfile on; # 开启高效文件传输模式
    #tcp_nopush     on; # 防止网络阻塞
    tcp_nodelay on; # 提高实时性
    keepalive_timeout 65; # 长连接超时时间

    # --- 包含虚拟主机配置 ---
    # !!! 关键: 加载 /etc/nginx/conf.d 目录下的所有 .conf 文件 !!!
    # 我们下面的 default.conf 就是通过这里被加载的
    include /etc/nginx/conf.d/*.conf;

}
